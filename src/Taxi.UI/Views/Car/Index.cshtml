@model Taxi.UI.Models.Cars.CarCollectionViewModel

@{
	ViewData["Title"] = "Автопарк";
}

<div class="form-group">
	<a class="btn btn-warning" asp-action="ShowTICars">Машины с ТО в этом месяце</a>
</div>

<form class="mt-3" asp-action="Create" asp-controller="Car" method="get">
	<div class="form-row">
		<div class="form-group" style="width: 30%;">
			<label>Выберите название марки для создания</label>
			<select name="brandId" class="form-control" asp-for="BrandId" asp-items="@(new SelectList
				(Model.Brands.Where(x => x.Id != 0), "Id", "Name"))"></select>
		</div>
		<div class="float-left ml-3 mt-4">
			<label></label>
			<input type="submit" class="form-control btn btn-success" value="Создать автомобиль" />
		</div>
	</div>
</form>

<form>
	<div class="form-row float-left">
		<div class="form-group w-25">
			<label>Марка автомобиля</label>
			@if (Model.BrandId != 0)
			{
				<select class="form-control" asp-for="BrandId" name="brandId" asp-items="@(new SelectList(
			    Model.Brands, "Id", "Name",
			    Model.Brands.FirstOrDefault(x => x.Id == Model.BrandId).Name))"></select>
			}
			else
			{
				<select class="form-control" asp-for="BrandId" name="brandId" asp-items="@(new SelectList(Model.Brands, "Id", "Name"))"></select>
			}
		</div>
		<div class="form-group ml-2" style="width: 20%;">
			<label>Год выпуска, от</label>
			<input class="form-control" type="number" name="issueYear" asp-for="IssueYear" value="@Model.IssueYear" />
		</div>
		<div class="form-group ml-2" style="width: 20%;">
			<label>Пробег, до (км)</label>
			<input type="number" class="form-control" name="mileage" asp-for="Mileage" value="@Model.Mileage" />
		</div>
		<div class="form-group ml-2" style="width: 20%;">
			<label>Цена, от</label>
			<input type="number" class="form-control" name="price" asp-for="Price" value="@Model.Price" />
		</div>
		<div class="float-left ml-3 mt-4">
			<label></label>
			<input type="submit" class="form-control btn btn-info" value="Найти" />
		</div>
	</div>

	<table class="table table-striped" style="font-size: 14px;">
		<tr>
			<th>Модель</th>
			<th>Гос. номер</th>
			<th>Год выпуска</th>
			<th>Цена</th>
			<th>Номер кузова</th>
			<th>Номер двигателя</th>
			<th>Последнее ТО</th>
			<th>Пробег</th>
			<th>Тариф</th>
			<th>Водитель</th>
			<th>Механик</th>
			<th>Действия</th>
		</tr>

		@foreach (var item in Model.Cars)
		{
			<tr>
				<td>@item.ModelName</td>
				<td>@item.RegistrationNumber</td>
				<td>@item.IssueYear</td>
				<td>@item.Price</td>
				<td>@item.BodyNumber</td>
				<td>@item.EngineNumber</td>
				<td>@item.LastTI.ToShortDateString()</td>
				<td>@item.Mileage</td>
				<td>@item.TariffName</td>
				<td>@item.DriverFullName</td>
				<td>@item.MechanicFullName</td>
				<td>
					<a asp-action="Update" class="btn btn-primary" asp-route-id="@item.Id">
						Изменить
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
							<path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
							<path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z" />
						</svg>
					</a>
					<a asp-action="Delete" class="btn btn-danger" asp-route-id="@item.Id">
						Удалить
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
							<path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
							<path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
						</svg>
					</a>
				</td>
			</tr>
		}
	</table>

	<pagination count-pages="Model.CountPages" name="page" asp-action="Index" asp-controller="Car" current-page="Model.CurrentPage"></pagination>

</form>